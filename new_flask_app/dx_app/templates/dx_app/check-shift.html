{% extends "layoutForLogined.html" %}

{% block content %}
<h2 class="text-3xl font-bold text-gray-800 mb-6 flex items-center">
    ğŸ“… ã‚·ãƒ•ãƒˆç¢ºèª
    <select id="month-select" class="ml-4 border border-gray-300 rounded p-2">
        {% for month in data["available_months"] %}
        <option value="{{ month['year'] }}-{{ month['month'] }}" {% if month['year'] == data["current_year"] and month['month'] == data["current_month"] %}selected{% endif %}>
            {{ month["year"] }}å¹´ {{ month["month"] }}æœˆ
        </option>
        {% endfor %}
    </select>
</h2>

<!-- ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ -->
<div id="calendar-container">
    <div class="grid grid-cols-7 gap-2 border border-gray-300 p-4 bg-white shadow-md rounded-lg">
        <!-- æ›œæ—¥ã®ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <div class="text-center font-bold text-red-500">æ—¥</div>
        <div class="text-center font-bold">æœˆ</div>
        <div class="text-center font-bold">ç«</div>
        <div class="text-center font-bold">æ°´</div>
        <div class="text-center font-bold">æœ¨</div>
        <div class="text-center font-bold">é‡‘</div>
        <div class="text-center font-bold text-blue-500">åœŸ</div>

        {% for week in data["calendar"] %}
            {% for day in week %}
                <div class="border border-gray-300 min-h-[100px] p-2 bg-gray-100 relative">
                    <div class="text-sm font-bold absolute top-1 left-1">{{ day["date"].day }}</div>

                    <table class="w-full mt-4 border-collapse">
                        <tbody>
                            {% for shift in day["shifts"] %}
                            <tr class="border border-gray-300 bg-white">
                                <td class="text-xs text-center p-1">
                                    {{ shift["time"] }}<br>
                                    {{ shift["student_grade"] }} - {{ shift["subject"] }}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% endfor %}
        {% endfor %}
    </div>
</div>

<script>
document.getElementById("month-select").addEventListener("change", function() {
    let selectedMonth = this.value;  // é¸æŠã•ã‚ŒãŸå¹´ã¨æœˆ (YYYY-MM)
    
    // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’æ›´æ–°ã™ã‚‹APIã‚’å‘¼ã³å‡ºã™
    fetch(`/get_calendar?month=${selectedMonth}`)
        .then(response => response.text())
        .then(html => {
            document.getElementById("calendar-container").innerHTML = html;
        });
});
</script>

{% endblock %}