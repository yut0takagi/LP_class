<h1>現在作成中です。</h1>

# 0. 本リポジトリについて
本リポジトリは、個別指導塾での業務効率化について生じていた課題とその改善についてまとめたものです。DX推進等について実務経験があるわけではなく見よう見真似で実装したものになりますので、参考程度に使ってくださると嬉しいです。よろしくお願いいたします。

# 1. 問題要件について
##  1.1. 現時点(2024年7月12日)で生じている課題
1. <strong>コマの割り振りにおける業務負荷が高く細分化しにくいこと</strong><br>
    当該個別指導塾においてコマの割り振り業務は社員一人が行なっている。具体的には、塾生の来塾可能日程と教務スタッフの出勤可能日程を回収し、それらをもとに教室PCで組んでいく。その中で、生徒の受講科目に対して指導できる教務スタッフが不足していたり生徒,教務スタッフともに来塾可能であるにもかかわらずブースが足りなかったりするなど懸念点,制約条件が多く存在している。そのため、日程が全て完成することはなく常に三日前までに完成させることを目標に実施している状態である。よって、次の来塾日がわからない生徒や教務スタッフの授業準備が厳かになる等の問題が生じており、品質が低下しかねない状況に陥っていた。
2. <strong>シフト提出や日程調査用紙が紙ベースであること</strong><br>
    それらの書類が紙面でやりとりされることに関しては、デジタル化など言われているが受け渡しが楽であり効率が良いのであれば問題視するほどではない。しかし、当該個別指導塾ではそれらの書類を回収してから教室PCのエクセルファイルに転記し、本部へ送る書類とコマの割り振り結果の出力書類を作成している。さらに、転記先のエクセルファイルのフォーマットが操作し難い形式となっており、転記に約2日かかっていた。さらに、その転記を行える教室PCは1台しかないため業務細分化を行えず社員が黙々とやらざるを得ない環境となっていた。そのため、転記の作業が自動化等できれば負担を軽減することができると考える。それに加えて、それらの書類が紙ベースであるからこそ編集,更新,確認くをしにくいという問題が生じている。提出後は一人の社員が管理しており入力状況について他のスタッフが知ることができないため、確認することが困難となる。しかし、小学生から高校生をクライアントとする企業であるからこそ、提出した内容を再度確認,変更したいと申し出る生徒が多数いる。さらに、記入するフォーマットがそれぞれの生徒で異なる(来塾不可能な日にちに斜線を引く生徒と来塾可能な日にちに線を引く生徒,三角を使う生徒,途中までしか記入しない生徒等)などにより入力作業が停滞することが多々ある。しかし、生徒への確認は生徒が来塾していなければできないため非常に非効率な作業となる場合が多い。そのため、紙ベースでの回収には改善する必要があると感じた。
3. <strong>教務スタッフの研修,ミーティング不足</strong><br>
    教務スタッフの研修については、初期研修として採用から1ヶ月間と定期研修として月1回程度行うのが望ましい。そして、定期ミーティングを実施し受験の動向や教務指導の中でのTipsやベストプラクティス,当該個別指導塾ならではの技術共有などをすることで、他者との差別化や品質の向上が望める。しかし、当該個別指導塾では、コマの割り振り業務に社員が追われており全体での情報共有が活発でないなどの理由からミーティングの実施は無くなった。さらに、初期研修ではアルバイトが担当することが頻繁にあり、指導技術が一つの組織として共有されているのではなく完全に属人化してしまっている。そのため、教務指導スタッフの当たり外れが大きいと述べる生徒も多々いる。よって、組織としての統一感をもつ必要がありそれらを共有,享受することを目的としたイベント(ミーティングや研修,指導マニュアルの読み込み等)を実施するべきであると考えた。
4. <strong>マニュアルの不足</strong><br>
    3の内容と酷似するのだが、当該個別指導塾では、指導マニュアルやコマの割り振りマニュアル,組織のICT機器の操作方法に関する明確なマニュアルがなく口頭で伝える傾向になっている。そのため、現環境を維持するために保守的になっている部分があり変革しづらい環境と言える。また、春の時期で教務スタッフの入社タイミングであるのにもかかわらず作成されていないため、非常に働きにくい環境であると言える。

# 2. 具体的な導入システムの設計とその内容
## 2.1. Google Spreadsheetによるシフト管理システムの導入とその運用について(ver.1)
### 開発環境について
本システムの開発に使用しているローカル環境は以下の通りです。   

> 開発用PC: `Apple MacBook Air M1 2020モデル`   
> 教室用PC: `Lenovo ThinkStation`<br>
> 開発時利用ツール: `Google Spread Sheet`   
> 開発時利用言語: `GAS`<br>
> 動作可能環境: `Google Chrome` , `Safari`,`Firefox`

### 2.1.1 各種機能について
1. Google Spread Sheet でのシフト管理
    Google Spread Sheetを共有し、編集権限を限定付与することでシフト提出をオンライン上で行いました。
    運用したシートは以下のサイトから閲覧可能としております。ただし、スタッフ氏名等は変えております。
    ```url
    https://docs.google.com/spreadsheets/d/1RhHQKz_VnE5092DTtkHDm88jv8AuY55PCxYU0BiCSa4/edit?usp=sharing
    ```
    各種ページは以下のとおりです。
    1. <storng>マニュアルページ</storng><br>
        マニュアルページでは、操作方法の説明や動作環境等についてまとめました。
        当該個別指導塾で勤務している教務スタッフは大学生が多く、Lineグループでのアンケート機能を用いた事前調査の中でOffice関連の操作方法はある程度理解している方が多いとわかりました。
        そのため、私が退職しても運用,変更等行えるようにマニュアルとして各種機能をまとめることとしました。その中で、操作を画面録画として保存しGoogleDriveの共有フォルダーにアップロードしておくことで、理解しやすくなると考え、そのリンクをSpreadSheetに掲載することとしました。

        ![fig](https://github.com/yut0takagi/LP_class/blob/main/fig/GoogleSpreadSheet%E6%93%8D%E4%BD%9C%E7%94%BB%E9%9D%A2/%E3%83%9E%E3%83%8B%E3%83%A5%E3%82%A2%E3%83%AB.png)
    
    2. <storng>勤務可能者検索</storng><br>
        シート2枚目には、勤務可能者検索シートを挿れました。当該個別指導塾では教務スタッフの約8割を大学生が占めています。
        そのため、大学の予定等で出勤が急遽難しくなった場合代行者を探す必要があります。
        しかし、先に述べたとおり他の教務スタッフがいつ出勤するのか把握することが困難でした。
        よって、本シートを全教務スタッフの勤務可能調査表と連携することで「誰がいつ出勤できるか」,「この日にこの科目を教えられる人は誰がいるのか」などを表形式で確認できるようにしました。
        さらに、教室でのPCによる代行者検索が頻繁に起きていたため、講師名や出勤可能日,科目等を選択式にして素早く操作できUXの向上を行いました。
        そして、前日や次の日をボタンで操作できる用意するために以下のコードをGoogleAppScriptで実行するようにしました。
        ```GAS
        function addOneDay() {
            var sheet = SpreadsheetApp.getActive().getSheetByName("勤務可能者検索")
            var dateValue = sheet.getRange("B7").getValue();
            dateValue.setDate(dateValue.getDate() + 1);
            sheet.getRange("B7").setValue(dateValue);
        }
        function minusOneDay() {
            var sheet = SpreadsheetApp.getActive().getSheetByName("勤務可能者検索")
            var dateValue = sheet.getRange("B7").getValue();
            dateValue.setDate(dateValue.getDate() - 1);
            sheet.getRange("B7").setValue(dateValue);
        }
        ```

        ![fig](https://github.com/yut0takagi/LP_class/blob/main/fig/GoogleSpreadSheet%E6%93%8D%E4%BD%9C%E7%94%BB%E9%9D%A2/%E5%8B%A4%E5%8B%99%E5%8F%AF%E8%83%BD%E8%80%85%E6%A4%9C%E7%B4%A2%E7%94%BB%E9%9D%A2.png)

    3. <storng>開講コマ設定</storng><br>
        当該個別指導塾では、開講する予定の日時と時間を事前に本部へ提出する必要がありました。
        また、全てを一括で管理するツールがないため、開講する予定でない時間に授業を入れてしまう等のミスが生じやすく振替を組む作業で時間を無駄に費やしてしまうことがありました。
        そのため、申請した開講情報を当該GoogleSpreadSheetに添付することで振替作業や代行検索を楽に行えるようにしました。
        そして、本シートは全てチェックボックスでの入力に書式を限定しており、そのにゅうりょhう情報をもとに勤務可能者検索のページの各セルの背景色を変更するなどの設定を行いました。
        具体的には、m月d日n限目のコマが開講していない場合は背景色を灰色にするなど設定しております。

        ![fig](https://github.com/yut0takagi/LP_class/blob/main/fig/GoogleSpreadSheet%E6%93%8D%E4%BD%9C%E7%94%BB%E9%9D%A2/%E9%96%8B%E8%AC%9B%E3%82%B3%E3%83%9E%E8%A8%AD%E5%AE%9A%E7%94%BB%E9%9D%A2.png)

    4. <storng>管理画面</storng><br>
        管理画面では、講師の追加と削除,シフト提出の該当期間,コマの設定時間,ブース数の設定,受け入れしている学年区分などを指定できるようにしました。
        さらに、勤務可能調査表を編集した際にChengeLogに追加される変更履歴をもとに最終確認日以降に変更された部分を明記する仕組みを取り入れました。
        そして最終更新日を本日にするボタンをGoogleAppScriptで記述し実行するようにしました。
        
        ```GAS
        function setDay(){
            var timeStamp = new Date();  // 現在の時刻
            var sheet = SpreadsheetApp.getActiveSheet();
            sheet.getRange("I3").setValue(timeStamp);
        }
        ```

        以前では、Lineにて社員の方に変更内容を逐一送り紙面と教室PC上で変更作業を実行していたため、勝手に知らない間に変更等は起こりませんでした。
        しかし、GoogleSpreadSheetを利用することでいつでも変更できるというメリットがある反面その変更が周知されておらず、後からタスクが増えてしまうことがありました。
        そのため、ChangeLogを利用して把握できるようにしました。
        そして、シフト提出状況を一括で把握できるように、各シートの入力状況を表と棒グラフで把握することができるようにしました。
        将来的には、シフト提出からコマの割り振りまでを行えるようにしたかったので、ブース数の指定や教室に関する情報を一枚のシートで管理できるようにしました。
        また、教務スタッフが新たに増えた場合は、シフト提出用のシート(氏名_勤務可能調査表)を作成し、講師指導科目のシートに一行追加するなどの作業が必要となります。
        ただ、各シートで記述している関数の中で正規表現を利用しているものが多くあるため入力ミス等が起こり適正な動作をしなかったり全体が小さなミスで使えなくなったりしてしまう場合が多かったです。
        そのため、全ての作業をGoogleAppScriptの関数として設定し、トリガーを管理画面に追加することで上記の操作を自動化しました。実行するGoogleAppScriptのコードは以下のとおりです。
        ```GAS
        function duplicateSheetWithPrompt() {
            var ss = SpreadsheetApp.getActiveSpreadsheet();
            var sheetA = ss.getSheetByName("temp");
            if (!sheetA) {
                Logger.log("指定したtempが見つかりません。管理者へお伝えください。");
                return;
            }
            var ui = SpreadsheetApp.getUi();
            var response = ui.prompt(
                "新規に作成するスタッフ名を入力してください。",
                "ここに入力：",
                ui.ButtonSet.OK_CANCEL
            );
            if (response.getSelectedButton() == ui.Button.OK) {
                var newSheetName = response.getResponseText();
                var newSheet = sheetA.copyTo(ss).setName(newSheetName + "_勤務可能調査表");
                newSheet.getRange("A1").setValue(newSheetName);
            } else {
                Logger.log("シート複製をキャンセルしました。");
            }
        }
        ```

        ![fig](https://github.com/yut0takagi/LP_class/blob/main/fig/GoogleSpreadSheet%E6%93%8D%E4%BD%9C%E7%94%BB%E9%9D%A2/%E7%AE%A1%E7%90%86%E7%94%BB%E9%9D%A2.png)

    5. <storng>ChangeLog 変更履歴自動記録画面</storng><br>
        管理画面の項で示した通り、変更履歴を自動で記録するシートを導入しました。
        初期の段階では、変更したら変更箇所を各自記入するようにしていましたが、面倒であり入力作業を忘れる等のミスが多発しました。
        そこで、GoogleAppScriptを用いて自動で記録するような関数を以下のようにコーディングして、運用しました。

        ```gas
        function onEditRecordLogAAA(e) {
        // --------------------------------------------------------------------------------
        // 1. 編集されたシート名をチェック
        // --------------------------------------------------------------------------------
        var editedSheet = e.range.getSheet();
        var editedSheetName = editedSheet.getName();
        // シート名に "勤務可能調査表" が含まれていない場合は処理しない
        if (editedSheetName.indexOf("勤務可能調査表") === -1) {
            return;
        }
        // --------------------------------------------------------------------------------
        // 2. ログを残すシートを指定
        // --------------------------------------------------------------------------------
        var ss = SpreadsheetApp.getActiveSpreadsheet();
        var logSheetName = "ChangeLog";
        var logSheet = ss.getSheetByName(logSheetName);
        // もしログ用シートが存在しない場合はスキップ or 必要に応じて作成
        if (!logSheet) {
            Logger.log("ログシート '" + logSheetName + "' が存在しません。");
            return;
        }
        // --------------------------------------------------------------------------------
        // 3. 変更されたセル情報を取得
        // --------------------------------------------------------------------------------
        var editedRange = e.range;             // 変更されたセル範囲 (Rangeオブジェクト)
        var oldValue = e.oldValue;            // 変更前の値 (インストール型トリガー必要)
        var newValue = e.value;               // 変更後の値 (インストール型トリガー必要)
        var cellA1Notation = editedRange.getA1Notation();
        // --------------------------------------------------------------------------------
        // 4. 編集ユーザーを取得 (環境によって取得できない場合あり)
        // --------------------------------------------------------------------------------
        var userEmail = (e.user) ? e.user.getEmail() : "不明";
        // --------------------------------------------------------------------------------
        // 5. ログの書き込み
        // --------------------------------------------------------------------------------
        var timeStamp = new Date();  // 現在の時刻
        var write_sheet = "_勤務可能調査表"
        var manageSheet = SpreadsheetApp.getActive().getSheetByName("管理画面")
        for (let i = 18; i < 35; i++) {
            if (editedSheetName ==  manageSheet.getRange("B"+i).getValue()+ write_sheet){
            manageSheet.getRange("D"+i).setValue(timeStamp)
            }
        }

        logSheet.appendRow([
            timeStamp,            // A列: 日時
            editedSheetName,      // B列: シート名
            cellA1Notation,       // C列: 変更セル(A1表記)
            oldValue,             // D列: 旧値
            newValue,             // E列: 新値
            userEmail             // F列: ユーザー
        ]);
        }
        ```

        ![fig](https://github.com/yut0takagi/LP_class/blob/main/fig/GoogleSpreadSheet%E6%93%8D%E4%BD%9C%E7%94%BB%E9%9D%A2/ChangeLog%20%E5%A4%89%E5%B1%A5%E6%AD%B4%E8%87%AA%E5%8B%95%E8%A8%98%E9%8C%B2%E7%94%BB%E9%9D%A2.png)

    6. <storng>簡易確認シート</storng><br>
        シフト提出されたシートを移動して確認する作業が非常に面倒であるため、確認用のシートを作成しました。
        具体的にはA1セルの氏名を選択すると該当する講師の勤務可能状況を見ることができるようにしています。

        ![fig](https://github.com/yut0takagi/LP_class/blob/main/fig/GoogleSpreadSheet%E6%93%8D%E4%BD%9C%E7%94%BB%E9%9D%A2/%E9%96%8B%E8%AC%9B%E3%82%B3%E3%83%9E%E8%A8%AD%E5%AE%9A%E7%94%BB%E9%9D%A2.png)

    7. <strong>指導可能科目入力画面</strong><br>
        教務スタッフがお互いの授業を見るといった機会が少なく、「誰がどの科目をどのレベルまで指導できるのか」を把握することができませんでした。
        そのため、コマの割り振り後に、指導負荷であることが判明し代行を探すなどのミスが多発していました。そのため、本ファイルを導入してから1週間以内に入力をお願いし、勤務可能者検索の画面等へ反映できるようにしました。

        ![fig](https://github.com/yut0takagi/LP_class/blob/main/fig/GoogleSpreadSheet%E6%93%8D%E4%BD%9C%E7%94%BB%E9%9D%A2/%E6%8C%87%E5%B0%8E%E5%8F%AF%E8%83%BD%E7%A7%91%E7%9B%AE%E5%85%A5%E5%8A%9B%E7%94%BB%E9%9D%A2.png)

    8. <strong>出勤可能時間時間入力画面(講師1_勤務可能調査表)</strong><br>
        シフト提出を行うシートです。入力,変更を全てチェックボックスで選択式にすることで、入力エラーがないようにしました。
        本シートが各職員分作成し、各シートにそれぞれ入力してもらうようにしました。
        また、シートの作成は初期をPythonのOpenPyxlで行い作成しました。その後、職員の追加等を行う際には、GoogleAppScriptでtempシートをコピーし作成するようにしました。
        初期の作成用コードは以下の通りです。
        ```Python
        import openpyxl
        from datetime import date
        path = "Path/to/勤務調査_調査用SS.xlsx"
        wb = openpyxl.load_workbook(path,data_only=False)
        ws_template = wb["temp"]
        # シートの選択を解除
        for ws in wb.worksheets:
            ws.sheet_view.tabSelected = None
        ws_template = wb["temp"]
        teachers_list=["講師名1","講師名2",]
        for teacher in teachers_list:
            ws_copy = wb.copy_worksheet(ws_template)
            ws_copy.title = f'{teacher}_勤務可能調査表'
            ws_copy.cell(1,1).value = teacher
            wb.move_sheet(ws_copy, offset=len(wb.sheetnames))
        wb.active = 0
        # ブック名を変更して保存
        wb.save('勤務調査_変更後new.xlsx')
        ```

        ![fig](https://github.com/yut0takagi/LP_class/blob/main/fig/GoogleSpreadSheet%E6%93%8D%E4%BD%9C%E7%94%BB%E9%9D%A2/%E5%87%BA%E5%8B%A4%E5%8F%AF%E8%83%BD%E6%99%82%E9%96%93%E5%85%A5%E5%8A%9B%E7%94%BB%E9%9D%A2(%E8%AC%9B%E5%B8%AB1_%E5%8B%A4%E5%8B%99%E5%8F%AF%E8%83%BD%E8%AA%BF%E6%9F%BB%E8%A1%A8).png)

### 2.1.2. 実装後、運用期間について　
    2024年10月に運用を開始し、そこから2ヶ月間の使用しました。そして、ミーティングとLineのアンケート機能を用いてフィードバックを行った結果、以下の問題が挙げられました。

    1. Google App Scriptのトリガー機能をPC以外の機器から利用できないこと
    2. Google Spreadsheetで入力する際、選択式にしていても、スマートフォンで操作すると入力タブが表示されてしまい、選択しにくいこと。
    3. スマートフォン端末でGoogle SpreadSheetでスクロールする際に、セルを選択してしまい使いづらかった。
    4. シフトの提出がオンラインでできるようになり、いつでも閲覧できるため提出業務が楽になった。
    5. シフトの割り振り業務や本部へ送信する書類の作成は教室PCで行う必要があったため、シフトの転記はする必要があった。
        ※ 入室可否について全てフォーマット通りに提出できているため再度確認する必要がなくなったのはよかった。
    6. 生徒からの来塾可能日の調査もGoogle Spread Sheetで行えるようにすれば、集約できて良いのではないか
    7. シフト提出のプロセスの見直しができたため、他の部分でも効率化できる部分があるのではないか
    8. 教師側の業務プロセスの改善とともに、生徒側の学習支援も連携させることで、より品質が高まるのではないか

## 2.2. Webアプリによるシフト提出からコマの割り振り,授業の管理まで改善(Ver.2)
### 開発環境について
本システムの開発に使用しているローカル環境は以下の通りです。   

> 開発用PC: `Apple MacBook Air M1 2020モデル`   
> 開発時利用ツール: `Visual Studio Code`, `Google Spread Sheet`, `Google Colaboratory`, `Line`   
> 開発時利用言語: `Python`,`SQL`,`HTML`,`CSS`,`JavaScript`   
> 開発に利用しているPythonライブラリ: `Pulp`, `Pandas`, `Matplotlib`,`Numpy`,`Openpyxl`    
> Webアプリケーション利用可能動作環境: `Google Chrome` , `Safari`,`Firefox`

### 2.2.1. 改善するべき課題について
* シフト提出ツールの操作性向上
    GoogleSpreadsheetではPCからだと操作しやすいが、スマートフォンからのアクセスが主流となっているため、スマートフォンからのアクセスを標準的に想定するべきであると考えました。
* シフト提出からコマの割り振り,本部への提出書類の作成までのプロセスを一元管理できる仕組み
    シフト管理はオンラインでできて教務スタッフ(アルバイト)は楽であるが、社員の業務負担軽減にはつながっていないとわかりました。そのため、シフトが提出されてからの工程においても完了できる仕組みづくりが重要であるとわかりました。
* Lineなどから容易に変更,把握できる仕組み
    Lineなどの身近な送受信を用いて変更できれば、代行検索や多くの指示が効率的になると考えます。
* 授業評価システム
    生徒の授業方針について各担当の教務スタッフによる独断の裁量となっているため、当該個別指導塾である価値が薄れ属人化が進んでしまっています。そのため、授業方針や授業単元について相談できるAIを活用したシステムの構築が望ましいと考えました。
* 教室管理,進路関係についてのAIアシストシステム
    まず、当該個別指導塾ならではのような差別化ポイントが現在創れていないという問題があります。なので、教室の書類をRAGとしてAIに学習させ指導方針について明確にアドバイスできるAIアシストツールを開発する非強うがあると感じました。また、生徒の進路指導についても過去の進学実績や合格実績を学習データとして取り入れることができるため、進路指導や入御うスケジュールの策定をアシストするシステムも構築するべきであると考えました。

### 2.2.2. 画面遷移図
画面遷移図は以下の通りです。
※SVGファイルであるため、背景が黒くなってしまう場合がございます。
![画面遷移図](https://github.com/yut0takagi/LP_class/blob/main/fig/%E7%94%BB%E9%9D%A2%E9%81%B7%E7%A7%BB%E5%9B%B3_2025_02_16.svg "Giithub")

### 2.2.3. 各種機能一覧
0. ログイン画面
    本ツールは将来的に複数の個別指導塾様からの利用が可能となることを考えて以下の情報としました。
    1. 氏名(姓と名)
    2. 所属会社(組織id)
    3. 部署(グループid)
    4. 個人識別番号(id)
    5. メールアドレス
    6. パスワード
    7. 電話番号
    <br>
    そして、アカウントログインに必要な項目は以下の通りとしました。
    1. メールアドレス
    2. パスワード
    ※初回ログイン時には、SMSを用いた認証を行います。

1. シフトの提出と確認
    シフト提出要請とシフト提出,管理を一括で行うために、本機能を追加した。
    シフト提出要請から管理までのフローは次のとおりです。
    0. 教室管理者(権限レベル0~3)がシフト提出頻度を設定する。
    1. 提出日になると、教務スタッフの登録したメールアドレスにシフト提出依頼を一斉送信
    2. メールに記載されているURLからログインし、フォームに回答する。
        ※期日内であれば、編集可能
    3. 入力が完了し、送信された情報を元に管理者用ダッシュボードに情報更新
    4. 提出期間2日前に催促メールを再度送信
    5. 提出期間終了後、全データを教務スタッフデータベースに反映する。

    催促メールのテンプレートは以下のとおりです。
    ```txt
    〇〇様、□□です。
    start日からend日までのシフト提出をお願いいたします。
    以下のURLからログインし、入力後完了ボタンを押して提出してください。
    htttps;//endpoint/shift/userid
    ```

2. 生徒管理
    生徒管理画面は以下のとおりです。
    
    * 新規生徒追加画面
        新規に生徒を追加する際にアクセスします。
        選択内容は、以下のとおりです。
        1. 生徒氏名(姓,名)
        2. 生徒id(任意の場合は空白で送信)
        3. 初期受講科目
        4. メールアドレス
        5. 入塾テストid
        >メールアドレスを入力することで、新規追加処理が完了するとメールを送信することができます。それにより、生徒側(保護者様)による登録作業へ移ることができます。

        >入塾テストidと紐づけることで、生徒の成績情報に紐付けます。ただし、入塾テストidの紐付けを行う場合には、テストのmeta情報を事前に保存しておく必要があります。


    * 生徒情報編集画面
        すでに登録処理を終えた(教室側で行う処理と生徒側(保護者様)が行う処理を終えた)場合に利用できます。編集できる生徒情報については以下のとおりです。
        * 生徒個人情報編集画面
            変更できる生徒個人情報は以下のとおりです。
            1. 生徒id
            2. メールアドレス
            3. 電話番号(通常連絡先,緊急連絡先1,2,3)
            4. 生年月日
            5. 性別
            6. 住所
            7. 経歴
            8. 性格等の情報
            9. 学校行事日程
            9. 面談記録
            10. 志望校等の登録情報
        * 教室全生徒成績一覧画面
            在籍する生徒の成績を一括で管理することができます。
            1. 成績の入力
                以下のテスト等の成績入力を行えるようにします。
                * 学校テスト
                * 模試
                * 学校小テスト
                * 指導塾でのテスト
            2. 宿題実施状況
                宿題実施状況についても、管理できるようにします。
                * 宿題内容
                * 宿題提出状況
                * 宿題完成度
                * 実施内容
                * 評価
                > 問題等を写真で撮影し反映できます。
        * 生徒受講科目管理画面
            生徒が授業を追加受講する場合には、以下のような内容の入力を行います。
            * 学年
            * 科目
            * 開始月
            * 終了月(未定の場合は、空白で完了)
            * 受講講座数
            * 理想配置曜日等
            * 理想配置教務スタッフ
            * 授業実施時懸念点
            * 指導方針等
            > 上記の情報を入力後、受講申請用紙印刷画面,提案可能日程印刷画面へ遷移します。

        * 授業新規割り振り画面
            新規期間に授業を割り振りする場合に利用します。当初は、全て手動で社員が行なっていたものを自動で行うことができます。具体的には、以下のように実行しています。
            1. 理論について
                実装の中で**線形計画法**を利用します。<br>
                線形計画法とは、複数の制約条件の元で目的関数を最大化,最小化する変数を導く手法で手法です。具体的には、以下のような問題が挙げられます。
                <br>
                >```txt
                >(問題)
                >りんご(a円)とぶどう(b円)を合わせて20個買います。ただし、りんごは、ぶどうの二倍以上の個数が必要です。その時の合計金額を最小化する個数の組み合わせはいくらか
                >```
                >
                >(解法)   
                >制約式1: $$ n_{apple} + n_{grape} = 20 $$
                >制約式2: $$ n_{apple} \geq 2n_{grape} $$
                >目的関数式: $$ n_{apple}*a + n_{grape}*b  \quad \rightarrow \quad min $$
                >   
                >  上記の式に対して二次元平面を考え、目的関数式の勾配ベクトルを求め最小化する。(図解法)
                <br>


                上記の理論では、図解法で行うためには2次元までに抑える必要があります。そのため、複数の制約条件がある中でのn次元線形計画問題では、pulpを用いた解法が得策であると考えます。
            2. 本課題における線形計画法制約条件について   
                本課題での制約条件を以下に定義する。
                1. 講師の出勤可能予定日であること   
                    割り振りを行う際に、講師の出勤日でない日に割り振ることは避ける必要がある。また、授業が入る,入らないという選択をbool型で定義することにしました。
                2. 生徒が来塾可能であること   
                    生徒も同様に来塾できない場合に授業を入れ込むことはするべきではない。
                3. 教務スタッフの指導可能科目について   
                    生徒の受講科目に対して教務スタッフも指導可能科目が存在します。具体的には、理系教務スタッフ(文系が苦手)が高校現代文を教えるのは品質の低下につながりうると言えます。そのため、教務スタッフの指導可能科目でない科目の授業数が0であると定義します。
                4. 教室開講時間について   
                    教室が曜日によって変わる必要があるため、閉室時間となっている授業コマの実施数を0とする必要があります。
                5. 教室ブース数について
                    複数の講師が出勤できる時間帯であっても教室ブース数を上回った場合には、超えることができません。従って、最大可能授業数を設定する必要があります。
                6. ※NG対応について   
                    生徒から教務スタッフのNG指示が出ている場合もあります。その場合には、NGを予定に考慮する必要があるため、NGである組み合わせの実施授業数を0とします。
            3. 本課題における線形計画法目的関数について   
                本課題での目的関数を一つに決定するのは難しいと言えます。なぜなら、以下のような考慮する点が存在するためです。   
                1. 生徒の学習リズムの安定化   
                    生徒が一定のサイクルで学習できる環境を提供することが望ましいと言えます。したがって、目的変数には、実施する授業頻度の分散の総和を最小化する割り振りとする案が挙げられます。具体的には、生徒Aの予定が3日連続で実施するとなった場合は授業間隔が1,1,1となり、それ以降の期間は授業しないことになってしまい、学習リズムが崩れかねません。そのため、生徒で実施間隔の分散を計算しそれを足し合わせ、総和を求めます。その総和が最大化する場合は、授業に偏りが生じており、最小化できている場合は、授業の割り振りが生徒にとって最適化されていると言えます。
                2. 教室稼働時間の最小化   
                    教室のランニングコストを最小化することも望ましいと言えます。なぜなら、実施している授業数が毎コマ少ない状況である場合、多くの時間を開講する必要があり、教室の運営費用の増大に直結します。そのため、授業料に盈虚するとも考えられるので、それを最小化する必要があると言えます。   

                    <br>
                したがって、上記の2つの目的関数を一つの目的変数に削減する必要があると考えました。そこで、線形回帰モデル式に着想を得てそれぞれの目的関数に重みづけをして大域的な最適を求められるのではないかと考えました。   
            4. 実装に必要となるデータ   
                実装には、以下のデータが必要となります。
                1. 教務スタッフの出勤可能時間
                2. 生徒の来塾可能時間
                3. 教務スタッフの指導可能科目
                4. 生徒の受講科目とその受講期間
                5. 設定科目の実施要領
                6. 教室の指導可能時間
                7. 教室のブース数
                8. 割り振り対象期間
            5. 割り振りの実装   
                一度、サンプルデータでの割り振り実施を以下のコードで実施しました。ただし、それぞれのデータについて、json形式で付与しております。
                ```Pytohn
                # 問題の定義
                prob = pulp.LpProblem('LP_class_Vacatrion', pulp.LpMinimize)
                # 変数を辞書化する
                x = pulp.LpVariable.dicts("x", List ,cat="Binary")
                # 教務スタッフについての制約条件
                for teacher in tqdm(teacher_list):
                    for day in date_list:
                        for index in range(7):
                            day_ = day.strftime("%m/%d/%a")
                            str = f"{day_}日{index}限"
                            #print(str)
                            for_teacher = [i for i in List if (f"-{teacher}-" in i and str in i)]
                            if len(for_teacher)>1:
                                #print(f"{teacher}における{day}の{index}限で{for_teacher}")
                                #print(len(for_teacher),for_teacher)
                                prob += pulp.lpSum(x[t] for t in for_teacher) <= 2

                for student in tqdm(student_list):
                    for day in date_list:
                        for index in range(7):
                            day_ = day.strftime("%m/%d/%a")
                            str = f"{day_}日{index}限"
                            #print(str)
                            for_student = [i for i in List if (f"{student}-" in i and str in i)]
                            if len(for_student)>1:
                                #print(f"{student}における{day}の{index}限で{for_student}")
                                #print(len(for_teacher),for_teacher)
                                prob += pulp.lpSum(x[t] for t in for_student) <= 1

                for day in tqdm(date_list):
                    for index in range(7):
                        day_ = day.strftime("%m/%d/%a")
                        str = f"{day_}日{index}限"
                        #print(str)
                        for booth in ["AB","CD","EF","GH","IJ"]:
                            for_booth_num = [i for i in List if (str in i) and booth in i]
                            if len(for_booth_num)>1:
                                #print(f"{str}限{booth}で{for_booth_num}")
                                #print(len(for_teacher),for_teacher)
                                prob += pulp.lpSum(x[t] for t in for_booth_num) <= 2

                # 生徒の受講しているコマを入れ込む
                for student in tqdm(student_list):
                    for subject in df_student.T[df_student.T[student]==1].index:
                        for_st_sub_num = [i for i in List if (f"{student}-" in i) and (f"{subject}-" in i)]
                        prob += pulp.lpSum(x[t] for t in for_st_sub_num) == 4

                for teacher in tqdm(teacher_list):
                    for_teacher_low = [i for i in List if teacher in i]
                    prob += pulp.lpSum(x[t] for t in for_teacher_low) <= 320

                # 目的変数としては、ブース稼働数最小限
                #ブース稼働数を変数とする必要がある。
                #例: 生徒53-教師0-科目0-02/14/Fri日5限-AB
                prob += pulp.lpSum(x[t] for t in [i for i in List if any(f"{index}限" in i for index in range(5))])
                ```
            7. 実施結果
                制約条件数は、生徒60人,教師15人とし、受講科目や指導可能科目を全てランダムとした時、約20万から40万となりました。それを用いて、Webアプリ上で実施のリクエストを送ると日程のデータベースをもとに実施するプログラムを構築しました。
        * 授業入れ込み画面
            授業が既に組まれている部分に授業を入れ込む場合は、データベースの教師指導科目と対象期間で絞り込みを行い表示するようにしました。
            従来では、Excelでデータ管理し、それを一度印刷し照らし合わせて評価するのに比べて、プルダウンで選択してくことで楽にコマの振替や代行を行えるようになりました。
        
        * 



