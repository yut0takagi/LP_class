# 要旨
## 本リポジトリについて
本リポジトリは、個別指導塾での業務効率化,サービス品質向上の一環で作成した学習支援,学習管理システムの作成,策定プロセスを明記したものです。<br>
具体的には、以下のプロセスについての業務効率化,サービス提供を行っております。<br>

1. 教務スタッフのシフト提出と通塾生の通塾可能日調査票の受け取りまでの提出状況管理システム
2. 講習期間におけるコマの割り振り自動化システム
3. 通常授業期間におけるコマの割り振りと変更の自動化システム<br>
    ※ 講習期間におけるプロセスと変わるため別々に明記しております。
4. 本部提出書類作成の自動化システム
5. 業務優先度可視化システム
6. AIエージェントによる学習スケジュール,指導方針策定アシストツール
7. Line連携による簡易編集システム(教務スタッフのみ)における利用方法の説明

## 本システムによる導入効果
本システムの導入により以下の点で業務効率とサービス品質の向上が見られました。
1. 社員の割り振りプロセスの時間短縮やシフト調整の幅が格段に上昇しました。<br>
    社員: コマの割り振り自動化による人員1名削減(今後は、教務スタッフの研修業務を行うことになりました。)
    生徒: 通塾日程をいつでも可視化できること, 教務スタッフの指導技術向上による品質向上

## 今後の展望
今後は、システムエラーの改善と機能増築を目指して日々フォローしていきます。
<br><br>

# 開発環境について
本システムの開発に使用しているローカル環境は以下の通りです。   

> 開発用PC: `Apple MacBook Air M1 2020モデル`   
> 開発時利用ツール: `Visual Studio Code`, `Google Spread Sheet`, `Google Colaboratory`, `Line`   
> 開発時利用言語: `Python`,`SQL`,`HTML`,`CSS`,`JavaScript`   
> 開発に利用しているPythonライブラリ: `Pulp`, `Pandas`, `Matplotlib`,`Numpy`,`Openpyxl`    
> Webアプリケーション利用可能動作環境: `Google Chrome` , `Safari`,`Firefox`

# 1. 問題要件定義
##  1.1. 現時点(2025/02/13)で生じている課題
1. 講習期間,通常授業期間におけるコマ割り振りの業務負荷が高いこと<br>
    ワークフローにおいて生徒それぞれで懸念内容が異なり、それらを総合的に把握する必要がある。そのため、社員が一人で組む必要がありタスク細分化が困難であるとともに、それによる弊害が多数確認できている。
2. 授業準備に割く時間がないこと<br>
    コマの割り振りに時間がかかることにより、生徒の授業日程が直前まで把握できず妥当な授業準備を行えていないこと。また、それにより授業時間内に指導外行為(今後の授業方針の策定や教材確認,テスト等の生徒情報の確認などの教科についての指導ではない部分)を行わざるを得ないこと。
3. 生徒,保護者における授業日程確認が困難であること<br>
    現在の授業日程お知らせのプロセスでは、<strong>来塾可能日の提出->コマの割り振り->授業日程表を紙面で受け渡し</strong>となっている。それにより、授業実施日でないとお知らせできず、授業日当日にお電話でお伝えとなる場合も生じている。また、それにより今後の宿題内容について明確に定めることができず生徒の継続的学習サイクルの阻害にもつながっている。
4. 教務スタッフの研修不足
    教務スタッフを採用してから生徒に指導するまでに約1ヶ月の期間研修業務を行う。しかし、1週間に1回1時間程度授業指導を行う程度であるとともに研修担当もアルバイト(アルバイトに指導の技術がないというのではなく、指導方針や授業実施における注意事項,マニュアル等がなく、研修担当時に個人の経験で指導することになってしまい、属人化してしまっているためアルバイトという書き方をした。)であるため、授業の進め方や指導の明確なコツを取得しない状態で指導を開始している。そのため、授業の品質低下につながっていると考える。実際に、教材や教育指導要領などを確認せずに指導していたことで保護者様からのクレームにつながったこともある。
5. マニュアル不足
    4の内容と類似するのだが、指導マニュアルやコマの割り振りマニュアル,組織のICT機器の操作方法に関する明確なマニュアルがなく口頭で享受する傾向となっている。そのため、現環境を維持するために保守的になっている部分があり変革しづらい環境と言える。
## 1.1 システム化の目的
本プロジェクトでは、現在のシフト管理フローについて課題な負担が生じており、提供するサービスの質悪化に繋がりかねないと判断したため、新システムを構築し、導入する。
## 1.2 背景
私の勤務している個別指導塾では、以下の問題が生じている。
1. シフト提出についての問題
    * シフト提出が紙ベースであり、提出後に社員がエクセルへの入力作業を行うため無駄が生じている。
    * 生徒の予定についても紙面で回収し、同様にpcへ転記している。
    * 教室pcのデータが共有サーバ上にあり、教室内でしか提出したシフトを確認できない。
    * 勤務予定を集約するファイルへのアクセス権限を有するスタッフが限られている。
    
    * シフト提出期間に出勤予定がないスタッフもいるため、コマの割り振りが後に伸びてしまう。
2. コマの割り振りにおけるワークフロー
    * 講師の出勤日程と指導科目, 生徒の来塾可能日程,受講科目,受講コマ数などの制約条件が多い。
    * 振替のコマもあるため、複雑化しやすい
    * コマの割り振り用ファイルへのアクセス権限を有するスタッフが限られるため、確認しにくい。
    * コマの割り振りが延滞することで、授業準備ができずに授業を実施することが多い。
    * コマの割り振りのためのマクロが使われているエクセルファイルがあるものの、使い勝手が悪い。
    * 教室の改装によりブース数が変化するものの、現行のシステムでは対応不可能。
## 1.3 ワークフロー改善における狙い
* シフト提出からコマの割り振りにおけるフローの効率化
* コマの割り振り業務の負担軽減
* 授業状況の共有の易化
* 情報伝達における人為的なミスの減少
## 1.4 ビジネスプロセス関連図
現行のビジネスプロセスについて以下に示す。
<!---後に記述します。-->

## 2. 画面遷移図
画面遷移図を以下に示す。

![画面遷移図](https://github.com/yut0takagi/LP_class/blob/main/fig/%E7%94%BB%E9%9D%A2%E9%81%B7%E7%A7%BB%E5%9B%B3.png?raw=true "Giithub")

### 2.1. 個人情報の編集
#### 2.1.1 個人情報変更について
個人情報の編集は、塾生,講師,管理者問わず、アプリの1ユーザーとしての個人情報編集を意味する。<br>
そのため、変更できる内容を以下のように定義する。
1. 性別<br>
    初期登録の画面にて設定した性別を変更する。<br>
2. 生年月日<br>
    初期登録の画面にて設定した生年月日を変更する。<br>
    ユーザーが学生である場合は、生年月日を学年として利用する。
4. メールアドレス<br>
    初期登録の画面にて設定したメールアドレスを変更する。<br>
    メールアドレスの変更を行なった場合は、メールアドレス確認画面を作成し、登録されたメールアドレスの正当性を確認する。
5. 住所
    <!--住所のデータについては、学習データとしないことに注意する。-->
    初期登録の画面にて設定した住所を変更する。<br>
    住所については任意とし、定期的なチラシ送付と個人成績や学習スケジュールの受信をご希望される方のみの入力とする。
6. 出勤,通塾校舎名と校舎ID<br>
    初期登録の画面にて登録した校舎名と校舎IDを変更する。<br>
    ただし、変更をする場合は管理者の審査を必要とする。
7. アイコンの変更
    ユーザーアイコンを変更する。<br>
    <!--後日精査必要-->
    利用可能拡張子は、<strong>.JPGか.HEIF</strong>とする
8. ログインパスワード<br>
    個人で設定したパスワードを変更する。<br>
    セキュリティ保護のため、変更フォームに入力するページへの遷移はパスワードの入力を必要とする。

<hr>

### 2.2. シフトの提出

### 2.3 生徒管理
#### 2.3.1. 授業割り振り画面
授業割り振りは、当初掲げていた改善すべきタスクの中で特に重視すべき問題である。そこで、以下のように改善策を講じる。
1. <strong>線形計画法</strong>による一定期間のコマの割り振り業務効率化   
    * 線形計画法とは   
        線形計画法とは、ORの最適化手法の一つである。<br>
        実装方法としては、Python(Pulp)やORtoolsなどが有名である。
    * 本タスクへの当てあめ   
        線形計画法では、目的関数と制約条件を定める必要がある。それぞれ、以下のように定義した。
        1. 制約条件について   
            1. *$生徒i$について*   
                * 生徒iが同一の授業時間に複数の授業を受けることができない。
                * 生徒iの授業数は受講申請した授業数と等しくする必要がある。
                * 生徒iの授業は、来塾可能授業時間でなければならない
                * 生徒iの来塾可能日程の回収ができていない場合、授業割り当てができない。
            2. *$講師j$について*   
                * 講師jが同一の授業時間に指導できる生徒数は$C_j$以下である。
                * 講師jが勤務できる授業時間でなければ授業を開講できない
                * 講師jが指導できる教科意外の授業は担当できない
            3. *教室状況,法的観点について*   
                * 稼働講師数は、ブース数以下にする必要がある。
                * 労働基準法により、講師jの週稼働時間が40時間以内にする必要がある。
                * 労働基準法により、講師jの一日の稼働時間が8時間以内にする必要がある。
                * 労働基準法により、講師jの一日の生徒指導時間が6時間以上の場合は、休憩時間1時間を開室時間内に取る必要がある。
        2. 目的関数
            生徒の実施授業の割り当ての分散が最大となる割り当てを最適な割り当てとする。
            具体的には、生徒iの単位期間内の授業数が$n$であり実施日が[day_1, day_2, day_3, day_4,,,day_n]である時、それらの分散は以下のように定義できる。   

            $$ Var(x) = \frac{1}{n}\sum_{k=1}^{n}(day_k - \frac{1}{n}\sum_{s=1}^{n}day_s)^2$$ 

            よって、目的変数は、すべての生徒での当該分散の総和と言えるため、以下のように定義する。

            $$ \sum_{i=1}^{I}Var(i) = \sum_{i=1}^{I}( \frac{1}{n}\sum_{k=1}^{n}(day_k - \frac{1}{n}\sum_{s=1}^{n}day_s)^2)$$ 

        3. 必要とするデータについて
            実装していく中で、教師や生徒の以下のデータが必要となる。
            1. 生徒の来塾可能日程(時限まで)
            2. 教師の出勤可能日程(時限まで)
            3. 教室の授業可能時限日程(時限まで)
            4. 生徒の受講科目
            5. 教務スタッフの指導可能科目(同一科目でも学年や難易度(学校テスト向けか入試対策までできるのかまで)について)
            6. 科目情報(指導形態)
                * 1:2での指導なのか,1:1のみの指導なのか<br>
                * 教室端末を必要とするか
            7. 教室同時限最大可能授業数(ブース数)
            8. 特記事項情報
                * 特定教師NGに関する制約情報
                * 特定講師優先紐付け
                * 生徒の一日の最大授業数








<br>
<br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br>

1. 教務スタッフの情報を定義
    1. 教務スタッフのyyyy年mm月dd日のnコマ目の入室可否のデータを変数として定義
        ```Python
        teachername_PossTime_yyyymmddn = pulp.LpVariable("teachername_PossTime_yyyymmddn",0,1,"Integer")
        ```
    2. 教務スタッフの科目コードabcdeの授業実施可否についてのデータを定義
        ```Python
        teachername_PossSubject_abcde = pulp.LpVariable("teachername_PossSubject_abcde",0,1,"Integer")
        ```
2. 環境因子の設定
    1. 教室の利用可能ブース数についての定義
        ```Python
        room_n_poss_yyyymmddn = pulp.LpVariable("room_n_poss_yyyymmddn",0,5,"Integer")
        ```
    2. 最大可能授業講師数
        該当時間における最大講師数の定義を行う。例えば、教室のブースが5つ空いている場合は、最大可能授業講師数は5になる。
        ```Python
        booth_num_yyyymmddn = pulp.LpVariable("booth_num_yyyymmddn",0,5,"Integer")
        ```
    3. 講習期間の定義   
        * 開始日: 2024/2/21
        * 終了日: 2024/3/31
        ```Python
        day_open_yyyymmddn = pulp.LpVariable("day_open_yyyymmddn",0,1,"Integer")
        ```
3. 生徒情報の定義
    生徒の来塾可能日程や履修科目やコマ数等について定義する。
    1. 来塾可能日程についての定義
    2. 履修科目の定義
    3. 残りコマ数の定義
    4. 主要な科目担当者の定義
    5. 生徒の情報(学年や性別等,NG講師等)の定義
    6. 備考
    